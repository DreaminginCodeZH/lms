# C程序设计专题 小班研讨专题报告

## 元数据

### 项目

图书管理系统

### 组号

22

### 成员

张海 3130000923

欧阳昱博 3130000844

### 报告提交人

张海 18970920012 <3130000923@zju.edu.cn>

### 任课教师

肖少拥

### 递交日期

2014年4月2日

## 功能说明

本系统具有对图书信息进行增加、修改、删除、多条件模糊搜索和显示的功能，图书信息使用二进制文件进行存储。

## 使用说明

### 安装说明

#### 开发环境

* 操作系统：Arch Linux / (Windows 8.1 + MingW)

* 集成开发环境：Eclipse Kepler with CDT

* 编译器：gcc 4.8

#### 可执行文件生成

* 使用 Eclipse with CDT 导入工程并进行组建。

* 编写`makefile`并手动进行编译链接。

#### 文件说明

* src/

  源代码文件

* doc/

  文档文件

### 操作说明

本系统采用字符菜单界面，进入系统时可以在主界面选择进行搜索、增加、修改、删除图书、退出系统操作，之后可根据界面提示进一步完成操作，操作完成后将再次回到主界面。

若发生数据文件损坏，系统将提示错误并退出。此时用户可以将数据文件`lms.dat`重命名或删除，则下次运行系统时将重新创建空的数据文件。

## 程序说明

### 程序架构

在写作本系统时，我们意识到许多代码都具有通用意义，因此可以以模块化的形式，将各个功能拆分并一般化，组成一个通用的库，以便代码复用。

在这个程序中，代码被主要拆分为三个模块：

1. 通用库

   通用库中主要包含了：

   * `bool`，`string`类型定义与相关常用函数；

   * 各类型序列化及逆序列化函数；

   * 通用的链表、动态数组实现；

   * 控制台函数，包括打印，读取，读取选项，清理，暂停等。

2. 图书信息数据结构

   * `Book`

     图书的数据结构，包含新建、删除、序列化、逆序列化、引用计数、打印等方法。

   * `BookList`

     图书列表的数据结构，“继承”于`LinkedList`类，包含新建、删除、序列化、逆序列化、添加、插入、删除、交换、排序、查找等方法。

   * `BookFilters`

     图书查询过滤器的集合，包括对`Book`各个成员进行模糊搜索、对所有成员进行模糊搜索以及使用多个以上过滤器进行过滤的复合过滤器。

3. 用户交互部分

   主要由`Lms`中的函数组成，调用`Console`中的函数实现了程序的各个功能对于用户的接口，对外提供各个功能的函数以及主循环的接口。

   在`main`中简单地调用了`Lms_loop()`，启动主循环，之后返回状态`0`。

### 数据结构

1. 链表

   本系统中`LinkedList`类提供了双向链表的实现，在基础的增减操作外同时提供了冒泡排序、顺序查找功能，并在`BookList`中被使用。

2. 动态数组

   本系统中`ArrayList`类提供了动态数组的实现，由于需求与时间均较少，仅仅提供了在尾部增加的功能，并在`BookFilters_compound`中被使用。

3. 图书类型

   本系统中`Book`类提供了对图书数据的表示，实现了要求中的字段，同时使用了字符串指针而非数组从而理论上没有引入对输入长度的限制。

### 函数说明

本系统对部分代码片段进行了注释，并采用`Doxygen`生成文档，现提供以下的一部分链接：

* [所有文件](doxygen/html/files.html)

* [`Book`](doxygen/html/Book_8c.html)

* [`BookList`](doxygen/html/BookList_8c.html)

## 系统设计

### 设计思想

1. 面向对象编程

   // TODO

2. 资源获取即初始化（RAII，Resource Acquisition Is Initialization）

   本系统在编写时借助于面向对象编程的方法，同时通过程序员间的约定，实行了`RAII`的策略，即每个对象的创建都由相应的`ClassName_new`执行而非手动分配内存，从而避免了未初始化的资源可能带来的程序错误。

3. 模块化

   本系统代码行数（不计空行）约为 1500 行，所以如何管理编写的代码是值得考虑的问题。编写时我们采用了模块化的思想，将任务拆分为不同的模块，从而分散到不同的文件，减小了代码的偶合度，同时增强了可复用性。

4. DRY（Don't Repeat Yourself）

   在编程过程中，常常会遇到有多个函数拥有重复的代码段，这时如果可以将重复的代码段提取成为一个通用的函数，则可以缩短单个函数的长度，使代码意图更加明确；同时可以将某个功能的实现集中，从而为代码维护带来便捷；此外这种方式也常常可以创造出可复用的函数。

### 使用工具

1. `git`与`GitHub`

2. `Doxygen`

   `Javadoc`风格文件内注释

### 编程风格

`1TBS`变体编程风格

`Java`风格命名规范

## 尚待改进

1. 进一步`OOP`的实现

2. 从文件中读入指令

   目前可以使用管道代替。

3. 将内容导出为文本文件

   目前可以使用重定向标准输出至文件代替。
